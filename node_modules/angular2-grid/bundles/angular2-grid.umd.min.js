!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports,require("@angular/core"),require("rxjs")):"function"==typeof define&&define.amd?define("angular2-grid",["exports","@angular/core","rxjs"],i):i(t["angular2-grid"]={},t.ng.core,t.rxjs)}(this,function(t,r,i){"use strict";function I(t){var i="function"==typeof Symbol&&t[Symbol.iterator],e=0;return i?i.call(t):{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}function D(t,i){return t.col===i.col?t.row-i.row:t.col-i.col}function M(t,i){return t.row===i.row?t.col-i.col:t.row-i.row}var h=function(){function t(t,i){this._ngEl=t,this._renderer=i}return t.prototype.registerGrid=function(t){this._ngGrid=t},t.prototype.ngOnInit=function(){this._renderer.setElementClass(this._ngEl.nativeElement,"grid-placeholder",!0),this._ngGrid.autoStyle&&this._renderer.setElementStyle(this._ngEl.nativeElement,"position","absolute")},t.prototype.setSize=function(t){this._size=t,this._recalculateDimensions()},t.prototype.setGridPosition=function(t){this._position=t,this._recalculatePosition()},t.prototype.setCascadeMode=function(t){switch(this._cascadeMode=t){case"up":case"left":default:this._renderer.setElementStyle(this._ngEl.nativeElement,"left","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"top","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"right",null),this._renderer.setElementStyle(this._ngEl.nativeElement,"bottom",null);break;case"right":this._renderer.setElementStyle(this._ngEl.nativeElement,"right","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"top","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"left",null),this._renderer.setElementStyle(this._ngEl.nativeElement,"bottom",null);break;case"down":this._renderer.setElementStyle(this._ngEl.nativeElement,"left","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"bottom","0px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"right",null),this._renderer.setElementStyle(this._ngEl.nativeElement,"top",null)}},t.prototype._setDimensions=function(t,i){this._renderer.setElementStyle(this._ngEl.nativeElement,"width",t+"px"),this._renderer.setElementStyle(this._ngEl.nativeElement,"height",i+"px")},t.prototype._setPosition=function(t,i){switch(this._cascadeMode){case"up":case"left":default:this._renderer.setElementStyle(this._ngEl.nativeElement,"transform","translate("+t+"px, "+i+"px)");break;case"right":this._renderer.setElementStyle(this._ngEl.nativeElement,"transform","translate("+-t+"px, "+i+"px)");break;case"down":this._renderer.setElementStyle(this._ngEl.nativeElement,"transform","translate("+t+"px, "+-i+"px)")}},t.prototype._recalculatePosition=function(){var t=(this._ngGrid.colWidth+this._ngGrid.marginLeft+this._ngGrid.marginRight)*(this._position.col-1)+this._ngGrid.marginLeft+this._ngGrid.screenMargin,i=(this._ngGrid.rowHeight+this._ngGrid.marginTop+this._ngGrid.marginBottom)*(this._position.row-1)+this._ngGrid.marginTop;this._setPosition(t,i)},t.prototype._recalculateDimensions=function(){var t=this._ngGrid.colWidth*this._size.x+(this._ngGrid.marginLeft+this._ngGrid.marginRight)*(this._size.x-1),i=this._ngGrid.rowHeight*this._size.y+(this._ngGrid.marginTop+this._ngGrid.marginBottom)*(this._size.y-1);this._setDimensions(t,i)},t.decorators=[{type:r.Component,args:[{selector:"ng-grid-placeholder",template:""}]}],t.ctorParameters=function(){return[{type:r.ElementRef},{type:r.Renderer}]},t}(),e=function(){function n(t,i,e,s){this._differs=t,this._ngEl=i,this._renderer=e,this.componentFactoryResolver=s,this.onDragStart=new r.EventEmitter,this.onDrag=new r.EventEmitter,this.onDragStop=new r.EventEmitter,this.onResizeStart=new r.EventEmitter,this.onResize=new r.EventEmitter,this.onResizeStop=new r.EventEmitter,this.onItemChange=new r.EventEmitter,this.colWidth=250,this.rowHeight=250,this.minCols=1,this.minRows=1,this.marginTop=10,this.marginRight=10,this.marginBottom=10,this.marginLeft=10,this.screenMargin=0,this.isDragging=!1,this.isResizing=!1,this.autoStyle=!0,this.resizeEnable=!0,this.dragEnable=!0,this.cascade="up",this.minWidth=100,this.minHeight=100,this.resizeDirections=n.CONST_DEFAULT_RESIZE_DIRECTIONS,this._items=new Map,this._draggingItem=null,this._resizingItem=null,this._resizeDirection=null,this._itemsInGrid=new Set,this._maxCols=0,this._maxRows=0,this._visibleCols=0,this._visibleRows=0,this._setWidth=250,this._setHeight=250,this._posOffset=null,this._adding=!1,this._placeholderRef=null,this._fixToGrid=!1,this._autoResize=!1,this._destroyed=!1,this._maintainRatio=!1,this._preferNew=!1,this._zoomOnDrag=!1,this._limitToScreen=!1,this._centerToScreen=!1,this._curMaxRow=0,this._curMaxCol=0,this._dragReady=!1,this._resizeReady=!1,this._elementBasedDynamicRowHeight=!1,this._itemFixDirection="cascade",this._collisionFixDirection="cascade",this._allowOverlap=!1,this._lastZValue=1,this._subscriptions=[],this._enabledListener=!1,this._config=n.CONST_DEFAULT_CONFIG,this._defineListeners()}return Object.defineProperty(n.prototype,"config",{set:function(t){null!=t&&"object"==typeof t&&(this.setConfig(t),null==this._differ&&null!=t&&(this._differ=this._differs.find(this._config).create()),this._differ.diff(this._config))},enumerable:!0,configurable:!0}),n.prototype.ngOnInit=function(){this._renderer.setElementClass(this._ngEl.nativeElement,"grid",!0),this.autoStyle&&this._renderer.setElementStyle(this._ngEl.nativeElement,"position","relative"),this.setConfig(this._config)},n.prototype.ngOnDestroy=function(){this._destroyed=!0,this._disableListeners()},n.prototype.generateItemUid=function(){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=16*Math.random()|0;return("x"==t?i:3&i|8).toString(16)});return this._items.has(t)?this.generateItemUid():t},n.prototype.setConfig=function(t){var i=this;this._config=t;var e=!1;for(var s in t){var n=t[s],o=n?parseInt(n):0;switch(s){case"margins":this.setMargins(n);break;case"col_width":this.colWidth=Math.max(o,1);break;case"row_height":this.rowHeight=Math.max(o,1);break;case"auto_style":this.autoStyle=!!n;break;case"auto_resize":this._autoResize=!!n;break;case"draggable":this.dragEnable=!!n;break;case"resizable":this.resizeEnable=!!n;break;case"max_rows":e=e||this._maxRows!=o,this._maxRows=o<0?0:o;break;case"max_cols":e=e||this._maxCols!=o,this._maxCols=o<0?0:o;break;case"visible_rows":this._visibleRows=Math.max(o,0);break;case"visible_cols":this._visibleCols=Math.max(o,0);break;case"min_rows":this.minRows=Math.max(o,1);break;case"min_cols":this.minCols=Math.max(o,1);break;case"min_height":this.minHeight=Math.max(o,1);break;case"min_width":this.minWidth=Math.max(o,1);break;case"zoom_on_drag":this._zoomOnDrag=!!n;break;case"cascade":this.cascade!=n&&(this.cascade=n,this._cascadeGrid());break;case"fix_to_grid":this._fixToGrid=!!n;break;case"maintain_ratio":this._maintainRatio=!!n;break;case"prefer_new":this._preferNew=!!n;break;case"limit_to_screen":this._limitToScreen=!this._autoResize&&!!n;break;case"center_to_screen":this._centerToScreen=!!n;break;case"resize_directions":this.resizeDirections=n||["bottomright","bottomleft","topright","topleft","right","left","bottom","top"];break;case"element_based_row_height":this._elementBasedDynamicRowHeight=!!n;break;case"fix_item_position_direction":this._itemFixDirection=n;break;case"fix_collision_position_direction":this._collisionFixDirection=n;break;case"allow_overlap":this._allowOverlap=!!n}}if(this._allowOverlap&&"off"!==this.cascade&&""!==this.cascade&&(console.warn("Unable to overlap items when a cascade direction is set."),this._allowOverlap=!1),this.dragEnable||this.resizeEnable?this._enableListeners():this._disableListeners(),"cascade"===this._itemFixDirection&&(this._itemFixDirection=this._getFixDirectionFromCascade()),"cascade"===this._collisionFixDirection&&(this._collisionFixDirection=this._getFixDirectionFromCascade()),this._limitToScreen){var r=this._getContainerColumns();this._maxCols!=r&&(this._maxCols=r,e=!0)}if(this._limitToScreen&&this._centerToScreen?this.screenMargin=this._getScreenMargin():this.screenMargin=0,this._maintainRatio&&(this.colWidth&&this.rowHeight?this._aspectRatio=this.colWidth/this.rowHeight:this._maintainRatio=!1),e){if(0<this._maxCols&&0<this._maxRows)switch(this.cascade){case"left":case"right":this._maxCols=0;break;case"up":case"down":default:this._maxRows=0}this._updatePositionsAfterMaxChange()}this._calculateColWidth(),this._calculateRowHeight();var h=this._maxCols*this.colWidth,a=this._maxRows*this.rowHeight;0<h&&this.minWidth>h&&(this.minWidth=.75*this.colWidth),0<a&&this.minHeight>a&&(this.minHeight=.75*this.rowHeight),this.minWidth>this.colWidth&&(this.minCols=Math.max(this.minCols,Math.ceil(this.minWidth/this.colWidth))),this.minHeight>this.rowHeight&&(this.minRows=Math.max(this.minRows,Math.ceil(this.minHeight/this.rowHeight))),0<this._maxCols&&this.minCols>this._maxCols&&(this.minCols=1),0<this._maxRows&&this.minRows>this._maxRows&&(this.minRows=1),this._updateRatio(),this._items.forEach(function(t){i._removeFromGrid(t),t.setCascadeMode(i.cascade)}),this._items.forEach(function(t){t.recalculateSelf(),i._addToGrid(t)}),this._cascadeGrid(),this._updateSize()},n.prototype.getItemPosition=function(t){return this._items.has(t)?this._items.get(t).getGridPosition():null},n.prototype.getItemSize=function(t){return this._items.has(t)?this._items.get(t).getSize():null},n.prototype.ngDoCheck=function(){if(null!=this._differ){var t=this._differ.diff(this._config);if(null!=t)return this._applyChanges(t),!0}return!1},n.prototype.setMargins=function(t){this.marginTop=Math.max(parseInt(t[0]),0),this.marginRight=2<=t.length?Math.max(parseInt(t[1]),0):this.marginTop,this.marginBottom=3<=t.length?Math.max(parseInt(t[2]),0):this.marginTop,this.marginLeft=4<=t.length?Math.max(parseInt(t[3]),0):this.marginRight},n.prototype.enableDrag=function(){this.dragEnable=!0},n.prototype.disableDrag=function(){this.dragEnable=!1},n.prototype.enableResize=function(){this.resizeEnable=!0},n.prototype.disableResize=function(){this.resizeEnable=!1},n.prototype.addItem=function(t){var i=this;if(t.setCascadeMode(this.cascade),!this._preferNew){var e=this._fixGridPosition(t.getGridPosition(),t.getSize());t.setGridPosition(e)}(null===t.uid||this._items.has(t.uid))&&(t.uid=this.generateItemUid()),this._items.set(t.uid,t),this._addToGrid(t),this._updateSize(),this.triggerCascade().then(function(){t.recalculateSelf(),t.onCascadeEvent(),i._emitOnItemChange()})},n.prototype.removeItem=function(t){var i=this;this._removeFromGrid(t),this._items["delete"](t.uid),this._destroyed||this.triggerCascade().then(function(){i._updateSize(),i._items.forEach(function(t){return t.recalculateSelf()}),i._emitOnItemChange()})},n.prototype.updateItem=function(t){var i=this;this._removeFromGrid(t),this._addToGrid(t),this.triggerCascade().then(function(){i._updateSize(),t.onCascadeEvent()})},n.prototype.triggerCascade=function(){var i=this;return this._cascadePromise||(this._cascadePromise=new Promise(function(t){setTimeout(function(){i._cascadePromise=null,i._cascadeGrid(null,null),t()},0)})),this._cascadePromise},n.prototype.triggerResize=function(){this.resizeEventHandler(null)},n.prototype.resizeEventHandler=function(t){if(this._calculateColWidth(),this._calculateRowHeight(),this._updateRatio(),this._limitToScreen){var i=this._getContainerColumns();this._maxCols!==i&&(this._maxCols=i,this._updatePositionsAfterMaxChange(),this._cascadeGrid()),this._centerToScreen&&(this.screenMargin=this._getScreenMargin(),this._items.forEach(function(t){t.recalculateSelf()}))}else this._autoResize&&this._items.forEach(function(t){t.recalculateSelf()});this._updateSize()},n.prototype.mouseDownEventHandler=function(t){var i=this._getMousePosition(t),e=this._getItemFromPosition(i);if(null!=e){var s=e.canResize(t);if(this.resizeEnable&&s)this._resizeReady=!0,this._resizingItem=e,this._resizeDirection=s,t.preventDefault();else if(this.dragEnable&&e.canDrag(t)){this._dragReady=!0;var n=(this._draggingItem=e).getPosition();this._posOffset={left:i.left-n.left,top:i.top-n.top},t.preventDefault()}}},n.prototype.mouseUpEventHandler=function(t){this.isDragging?this._dragStop(t):this.isResizing?this._resizeStop(t):(this._dragReady||this._resizeReady)&&(this._cleanDrag(),this._cleanResize())},n.prototype.mouseMoveEventHandler=function(t){if(this._resizeReady)return this._resizeStart(t),void t.preventDefault();if(this._dragReady)return this._dragStart(t),void t.preventDefault();if(this.isDragging)this._drag(t);else if(this.isResizing)this._resize(t);else{var i=this._getMousePosition(t),e=this._getItemFromPosition(i);e&&e.onMouseMove(t)}},n.prototype._getFixDirectionFromCascade=function(){switch(this.cascade){case"up":case"down":default:return"vertical";case"left":case"right":return"horizontal"}},n.prototype._updatePositionsAfterMaxChange=function(){var n=this;this._items.forEach(function(t){var i=t.getGridPosition(),e=t.getSize();if(!(!n._hasGridCollision(i,e)&&n._isWithinBounds(i,e)&&e.x<=n._maxCols&&e.y<=n._maxRows)){if(n._removeFromGrid(t),0<n._maxCols&&e.x>n._maxCols?(e.x=n._maxCols,t.setSize(e)):0<n._maxRows&&e.y>n._maxRows&&(e.y=n._maxRows,t.setSize(e)),n._hasGridCollision(i,e)||!n._isWithinBounds(i,e,!0)){var s=n._fixGridPosition(i,e);t.setGridPosition(s)}n._addToGrid(t)}})},n.prototype._calculateColWidth=function(){if(this._autoResize&&(0<this._maxCols||0<this._visibleCols)){var t=0<this._maxCols?this._maxCols:this._visibleCols,i=this._ngEl.nativeElement.getBoundingClientRect().width,e=Math.floor(i/t);0<(e-=this.marginLeft+this.marginRight)&&(this.colWidth=e)}(this.colWidth<this.minWidth||this.minCols>this._config.min_cols)&&(this.minCols=Math.max(this._config.min_cols,Math.ceil(this.minWidth/this.colWidth)))},n.prototype._calculateRowHeight=function(){if(this._autoResize&&(0<this._maxRows||0<this._visibleRows)){var t=0<this._maxRows?this._maxRows:this._visibleRows,i=void 0;i=this._elementBasedDynamicRowHeight?this._ngEl.nativeElement.getBoundingClientRect().height:window.innerHeight-this.marginTop-this.marginBottom;var e=Math.max(Math.floor(i/t),this.minHeight);0<(e-=this.marginTop+this.marginBottom)&&(this.rowHeight=e)}(this.rowHeight<this.minHeight||this.minRows>this._config.min_rows)&&(this.minRows=Math.max(this._config.min_rows,Math.ceil(this.minHeight/this.rowHeight)))},n.prototype._updateRatio=function(){this._autoResize&&this._maintainRatio&&(0<this._maxCols&&this._visibleRows<=0?this.rowHeight=this.colWidth/this._aspectRatio:0<this._maxRows&&this._visibleCols<=0?this.colWidth=this._aspectRatio*this.rowHeight:0==this._maxCols&&0==this._maxRows&&(0<this._visibleCols?this.rowHeight=this.colWidth/this._aspectRatio:0<this._visibleRows&&(this.colWidth=this._aspectRatio*this.rowHeight)))},n.prototype._applyChanges=function(t){var i=this;t.forEachAddedItem(function(t){i._config[t.key]=t.currentValue}),t.forEachChangedItem(function(t){i._config[t.key]=t.currentValue}),t.forEachRemovedItem(function(t){delete i._config[t.key]}),this.setConfig(this._config)},n.prototype._resizeStart=function(t){this.resizeEnable&&this._resizingItem&&(this._resizingItem.startMoving(),this._removeFromGrid(this._resizingItem),this._createPlaceholder(this._resizingItem),this._allowOverlap&&(this._resizingItem.zIndex=this._lastZValue++),this.isResizing=!0,this._resizeReady=!1,this.onResizeStart.emit(this._resizingItem),this._resizingItem.onResizeStartEvent())},n.prototype._dragStart=function(t){this.dragEnable&&this._draggingItem&&(this._draggingItem.startMoving(),this._removeFromGrid(this._draggingItem),this._createPlaceholder(this._draggingItem),this._allowOverlap&&(this._draggingItem.zIndex=this._lastZValue++),this.isDragging=!0,this._dragReady=!1,this.onDragStart.emit(this._draggingItem),this._draggingItem.onDragStartEvent(),this._zoomOnDrag&&this._zoomOut())},n.prototype._zoomOut=function(){this._renderer.setElementStyle(this._ngEl.nativeElement,"transform","scale(0.5, 0.5)")},n.prototype._resetZoom=function(){this._renderer.setElementStyle(this._ngEl.nativeElement,"transform","")},n.prototype._drag=function(t){if(this.isDragging){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty();var i=this._getMousePosition(t),e=i.left-this._posOffset.left,s=i.top-this._posOffset.top,n=this._draggingItem.getGridPosition(),o=this._calculateGridPosition(e,s),r=this._draggingItem.getSize();o=this._fixPosToBoundsX(o,r),this._isWithinBoundsY(o,r)||(o=this._fixPosToBoundsY(o,r)),o.col==n.col&&o.row==n.row||(this._draggingItem.setGridPosition(o,this._fixToGrid),this._placeholderRef.instance.setGridPosition(o),0<=["up","down","left","right"].indexOf(this.cascade)&&(this._fixGridCollisions(o,r),this._cascadeGrid(o,r))),this._fixToGrid||this._draggingItem.setPosition(e,s),this.onDrag.emit(this._draggingItem),this._draggingItem.onDragEvent()}},n.prototype._resize=function(t){if(this.isResizing){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty();var i=this._getMousePosition(t),e=this._resizingItem.getPosition(),s=this._resizingItem.getDimensions(),n=e.left+s.width,o=e.top+s.height,r=this._resizeDirection.includes("top"),h=this._resizeDirection.includes("bottom"),a=this._resizeDirection.includes("left"),l=this._resizeDirection.includes("right")?i.left-e.left+1:a?n-i.left+1:s.width,_=h?i.top-e.top+1:r?o-i.top+1:s.height;l<this.minWidth&&(l=this.minWidth),_<this.minHeight&&(_=this.minHeight),l<this._resizingItem.minWidth&&(l=this._resizingItem.minWidth),_<this._resizingItem.minHeight&&(_=this._resizingItem.minHeight);var c=e.left,g=e.top;a&&(c=n-l),r&&(g=o-_);var m=this._calculateGridSize(l,_),d=this._resizingItem.getSize(),u=this._resizingItem.getGridPosition(),f=u.col+d.x,p=u.row+d.y,y=Object.assign({},u);this._resizeDirection.includes("top")&&(y.row=p-m.y),this._resizeDirection.includes("left")&&(y.col=f-m.x),this._isWithinBoundsX(y,m)||(m=this._fixSizeToBoundsX(y,m)),this._isWithinBoundsY(y,m)||(m=this._fixSizeToBoundsY(y,m)),(m=this._resizingItem.fixResize(m)).x==d.x&&m.y==d.y||(this._resizingItem.setGridPosition(y,this._fixToGrid),this._placeholderRef.instance.setGridPosition(y),this._resizingItem.setSize(m,this._fixToGrid),this._placeholderRef.instance.setSize(m),0<=["up","down","left","right"].indexOf(this.cascade)&&(this._fixGridCollisions(y,m),this._cascadeGrid(y,m))),this._fixToGrid||(this._resizingItem.setDimensions(l,_),this._resizingItem.setPosition(c,g)),this.onResize.emit(this._resizingItem),this._resizingItem.onResizeEvent()}},n.prototype._dragStop=function(t){if(this.isDragging){this.isDragging=!1;var i=this._draggingItem.getGridPosition();this._draggingItem.setGridPosition(i),this._addToGrid(this._draggingItem),this._cascadeGrid(),this._updateSize(),this._draggingItem.stopMoving(),this._draggingItem.onDragStopEvent(),this.onDragStop.emit(this._draggingItem),this._cleanDrag(),this._placeholderRef.destroy(),this._emitOnItemChange(),this._zoomOnDrag&&this._resetZoom()}},n.prototype._resizeStop=function(t){if(this.isResizing){this.isResizing=!1;var i=this._resizingItem.getSize();this._resizingItem.setSize(i);var e=this._resizingItem.getGridPosition();this._resizingItem.setGridPosition(e),this._addToGrid(this._resizingItem),this._cascadeGrid(),this._updateSize(),this._resizingItem.stopMoving(),this._resizingItem.onResizeStopEvent(),this.onResizeStop.emit(this._resizingItem),this._cleanResize(),this._placeholderRef.destroy(),this._emitOnItemChange()}},n.prototype._cleanDrag=function(){this._draggingItem=null,this._posOffset=null,this.isDragging=!1,this._dragReady=!1},n.prototype._cleanResize=function(){this._resizingItem=null,this._resizeDirection=null,this.isResizing=!1,this._resizeReady=!1},n.prototype._calculateGridSize=function(t,i){t+=this.marginLeft+this.marginRight,i+=this.marginTop+this.marginBottom;var e=Math.max(this.minCols,Math.round(t/(this.colWidth+this.marginLeft+this.marginRight))),s=Math.max(this.minRows,Math.round(i/(this.rowHeight+this.marginTop+this.marginBottom)));return this._isWithinBoundsX({col:1,row:1},{x:e,y:s})||(e=this._maxCols),this._isWithinBoundsY({col:1,row:1},{x:e,y:s})||(s=this._maxRows),{x:e,y:s}},n.prototype._calculateGridPosition=function(t,i){var e=Math.max(1,Math.round(t/(this.colWidth+this.marginLeft+this.marginRight))+1),s=Math.max(1,Math.round(i/(this.rowHeight+this.marginTop+this.marginBottom))+1);return this._isWithinBoundsX({col:e,row:s},{x:1,y:1})||(e=this._maxCols),this._isWithinBoundsY({col:e,row:s},{x:1,y:1})||(s=this._maxRows),{col:e,row:s}},n.prototype._hasGridCollision=function(t,i){var e=this._getCollisions(t,i);return null!=e&&0!=e.length&&e.some(function(t){return!(null===t)})},n.prototype._getCollisions=function(t,i){var r=this;if(this._allowOverlap)return[];var h=[];t.col||(t.col=1),t.row||(t.row=1);var a=t.col,l=t.col+i.x,_=t.row,c=t.row+i.y;return this._itemsInGrid.forEach(function(t){var i=r._items.get(t);if(i){var e=i.col,s=i.col+i.sizex,n=i.row,o=i.row+i.sizey;a<s&&e<l&&(_<o&&n<c)&&h.push(i)}else r._itemsInGrid["delete"](t)}),h},n.prototype._fixGridCollisions=function(t,i){var e=this._getCollisions(t,i);if(0!==e.length){try{for(var s=I(e),n=s.next();!n.done;n=s.next()){var o=n.value;this._removeFromGrid(o);var r=o.getSize(),h=o.getGridPosition(),a={col:h.col,row:h.row};"vertical"===this._collisionFixDirection?(a.row=t.row+i.y,this._isWithinBoundsY(a,r)||(a.col=t.col+i.x,a.row=1)):"horizontal"===this._collisionFixDirection&&(a.col=t.col+i.x,this._isWithinBoundsX(a,r)||(a.col=1,a.row=t.row+i.y)),o.setGridPosition(a),this._fixGridCollisions(a,r),this._addToGrid(o),o.onCascadeEvent()}}catch(c){l={error:c}}finally{try{n&&!n.done&&(_=s["return"])&&_.call(s)}finally{if(l)throw l.error}}var l,_;this._fixGridCollisions(t,i)}},n.prototype._cascadeGrid=function(t,i){var e=this;if(!this._destroyed&&!this._allowOverlap){if(!t!=!i)throw new Error("Cannot cascade with only position and not dimensions");this.isDragging&&this._draggingItem&&!t&&!i?(t=this._draggingItem.getGridPosition(),i=this._draggingItem.getSize()):this.isResizing&&this._resizingItem&&!t&&!i&&(t=this._resizingItem.getGridPosition(),i=this._resizingItem.getSize());var s,n,o,r,h=Array.from(this._itemsInGrid,function(t){return e._items.get(t)});switch(this.cascade){case"up":case"down":h=h.sort(M);var a=new Map;try{for(var l=I(h),_=l.next();!_.done;_=l.next()){if(!(E=_.value).isFixed){for(var c=E.getSize(),g=E.getGridPosition(),m=a.get(g.col)||1,d=1;d<c.x;d++){var u=a.get(g.col+d)||1;m=Math.max(u,m)}var f=g.col,p=g.col+c.x;if(t&&i)if(p>t.col&&f<t.col+i.x)c.y<=t.row-m||(m=Math.max(m,t.row+i.y));var y={col:g.col,row:m};m!=g.row&&this._isWithinBoundsY(y,c)&&(this._removeFromGrid(E),E.setGridPosition(y),E.onCascadeEvent(),this._addToGrid(E));for(d=0;d<c.x;d++)a.set(g.col+d,m+c.y)}}}catch(b){s={error:b}}finally{try{_&&!_.done&&(n=l["return"])&&n.call(l)}finally{if(s)throw s.error}}break;case"left":case"right":h=h.sort(D);var v=new Map;try{for(var x=I(h),w=x.next();!w.done;w=x.next()){c=(E=w.value).getSize(),g=E.getGridPosition();var E,z=v.get(g.row)||1;for(d=1;d<c.y;d++){var C=v.get(g.row+d)||1;z=Math.max(C,z)}var S=g.row,R=g.row+c.y;if(t&&i)if(R>t.col&&S<t.col+i.x)c.x<=t.col-z||(z=Math.max(z,t.col+i.x));y={col:z,row:g.row};z!=g.col&&this._isWithinBoundsX(y,c)&&(this._removeFromGrid(E),E.setGridPosition(y),E.onCascadeEvent(),this._addToGrid(E));for(d=0;d<c.y;d++)v.set(g.row+d,z+c.x)}}catch(G){o={error:G}}finally{try{w&&!w.done&&(r=x["return"])&&r.call(x)}finally{if(o)throw o.error}}}}},n.prototype._fixGridPosition=function(t,i){if(!this._hasGridCollision(t,i))return t;var e,s,n,o,r=0===this._maxRows?this._getMaxRow():this._maxRows,h=0===this._maxCols?this._getMaxCol():this._maxCols,a={col:t.col,row:t.row};if("vertical"===this._itemFixDirection)t:for(;a.col<=r;){var l=this._getItemsInVerticalPath(a,i,a.row),_=a.row;try{for(var c=I(l),g=c.next();!g.done;g=c.next()){if((f=g.value).row-_>=i.y){a.row=_;break t}_=f.row+f.sizey}}catch(p){e={error:p}}finally{try{g&&!g.done&&(s=c["return"])&&s.call(c)}finally{if(e)throw e.error}}if(r-_>=i.y){a.row=_;break t}a.col=Math.max(a.col+1,Math.min.apply(Math,l.map(function(t){return t.col+i.x}))),a.row=1}else if("horizontal"===this._itemFixDirection)t:for(;a.row<=r;){l=this._getItemsInHorizontalPath(a,i,a.col);var m=a.col;try{for(var d=I(l),u=d.next();!u.done;u=d.next()){var f;if((f=u.value).col-m>=i.x){a.col=m;break t}m=f.col+f.sizex}}catch(y){n={error:y}}finally{try{u&&!u.done&&(o=d["return"])&&o.call(d)}finally{if(n)throw n.error}}if(h-m>=i.x){a.col=m;break t}a.row=Math.max(a.row+1,Math.min.apply(Math,l.map(function(t){return t.row+i.y}))),a.col=1}return a},n.prototype._getItemsInHorizontalPath=function(e,t,s){var n=this;void 0===s&&(s=0);var o=[],r=e.row+t.y-1;return this._itemsInGrid.forEach(function(t){var i=n._items.get(t);i.col+i.sizex-1<s||i.row>r||i.row+i.sizey-1<e.row||o.push(i)}),o},n.prototype._getItemsInVerticalPath=function(e,t,s){var n=this;void 0===s&&(s=0);var o=[],r=e.col+t.x-1;return this._itemsInGrid.forEach(function(t){var i=n._items.get(t);i.row+i.sizey-1<s||i.col>r||i.col+i.sizex-1<e.col||o.push(i)}),o},n.prototype._isWithinBoundsX=function(t,i,e){return void 0===e&&(e=!1),0==this._maxCols||e&&1==t.col||t.col+i.x-1<=this._maxCols},n.prototype._fixPosToBoundsX=function(t,i){return this._isWithinBoundsX(t,i)||(t.col=Math.max(this._maxCols-(i.x-1),1),t.row++),t},n.prototype._fixSizeToBoundsX=function(t,i){return this._isWithinBoundsX(t,i)||(i.x=Math.max(this._maxCols-(t.col-1),1),i.y++),i},n.prototype._isWithinBoundsY=function(t,i,e){return void 0===e&&(e=!1),0==this._maxRows||e&&1==t.row||t.row+i.y-1<=this._maxRows},n.prototype._fixPosToBoundsY=function(t,i){return this._isWithinBoundsY(t,i)||(t.row=Math.max(this._maxRows-(i.y-1),1),t.col++),t},n.prototype._fixSizeToBoundsY=function(t,i){return this._isWithinBoundsY(t,i)||(i.y=Math.max(this._maxRows-(t.row-1),1),i.x++),i},n.prototype._isWithinBounds=function(t,i,e){return void 0===e&&(e=!1),this._isWithinBoundsX(t,i,e)&&this._isWithinBoundsY(t,i,e)},n.prototype._fixPosToBounds=function(t,i){return this._fixPosToBoundsX(this._fixPosToBoundsY(t,i),i)},n.prototype._fixSizeToBounds=function(t,i){return this._fixSizeToBoundsX(t,this._fixSizeToBoundsY(t,i))},n.prototype._addToGrid=function(t){var i=t.getGridPosition(),e=t.getSize();this._hasGridCollision(i,e)&&(this._fixGridCollisions(i,e),i=t.getGridPosition()),this._allowOverlap&&(t.zIndex=this._lastZValue++),this._itemsInGrid.add(t.uid)},n.prototype._removeFromGrid=function(t){this._itemsInGrid["delete"](t.uid)},n.prototype._updateSize=function(){if(!this._destroyed){var t=this._getMaxCol(),i=this._getMaxRow();t==this._curMaxCol&&i==this._curMaxRow||(this._curMaxCol=t,this._curMaxRow=i),this._renderer.setElementStyle(this._ngEl.nativeElement,"width","100%"),this._elementBasedDynamicRowHeight||this._renderer.setElementStyle(this._ngEl.nativeElement,"height",i*(this.rowHeight+this.marginTop+this.marginBottom)+"px")}},n.prototype._getMaxRow=function(){var e=this,t=Array.from(this._itemsInGrid,function(t){var i=e._items.get(t);return i?i.row+i.sizey-1:0});return Math.max.apply(null,t)},n.prototype._getMaxCol=function(){var e=this,t=Array.from(this._itemsInGrid,function(t){var i=e._items.get(t);return i?i.col+i.sizex-1:0});return Math.max.apply(null,t)},n.prototype._getMousePosition=function(t){(window.TouchEvent&&t instanceof TouchEvent||t.touches||t.changedTouches)&&(t=0<t.touches.length?t.touches[0]:t.changedTouches[0]);var i=this._ngEl.nativeElement.getBoundingClientRect(),e=t.clientX-i.left,s=t.clientY-i.top;return"down"==this.cascade&&(s=i.top+i.height-t.clientY),"right"==this.cascade&&(e=i.left+i.width-t.clientX),this.isDragging&&this._zoomOnDrag&&(e*=2,s*=2),{left:e,top:s}},n.prototype._getAbsoluteMousePosition=function(t){return(window.TouchEvent&&t instanceof TouchEvent||t.touches||t.changedTouches)&&(t=0<t.touches.length?t.touches[0]:t.changedTouches[0]),{left:t.clientX,top:t.clientY}},n.prototype._getContainerColumns=function(){var t=this._ngEl.nativeElement.getBoundingClientRect().width,i=this.colWidth+this.marginLeft+this.marginRight;return Math.floor(t/i)},n.prototype._getContainerRows=function(){var t=window.innerHeight-this.marginTop-this.marginBottom;return Math.floor(t/(this.rowHeight+this.marginTop+this.marginBottom))},n.prototype._getScreenMargin=function(){var t=this._ngEl.nativeElement.getBoundingClientRect().width,i=this.colWidth+this.marginLeft+this.marginRight;return Math.floor((t-this._maxCols*i)/2)},n.prototype._getItemFromPosition=function(s){var i=this;return Array.from(this._itemsInGrid,function(t){return i._items.get(t)}).find(function(t){if(!t)return!1;var i=t.getDimensions(),e=t.getPosition();return s.left>=e.left&&s.left<e.left+i.width&&s.top>=e.top&&s.top<e.top+i.height})},n.prototype._createPlaceholder=function(t){var i=t.getGridPosition(),e=t.getSize(),s=this.componentFactoryResolver.resolveComponentFactory(h),n=t.containerRef.createComponent(s),o=(this._placeholderRef=n).instance;o.registerGrid(this),o.setCascadeMode(this.cascade),o.setGridPosition({col:i.col,row:i.row}),o.setSize({x:e.x,y:e.y})},n.prototype._emitOnItemChange=function(){var i=this,t=Array.from(this._itemsInGrid).map(function(t){return i._items.get(t)}).filter(function(t){return!!t}).map(function(t){return t.getEventOutput()});this.onItemChange.emit(t)},n.prototype._defineListeners=function(){var t=this._ngEl.nativeElement;this._documentMousemove$=i.fromEvent(document,"mousemove"),this._documentMouseup$=i.fromEvent(document,"mouseup"),this._mousedown$=i.fromEvent(t,"mousedown"),this._mousemove$=i.fromEvent(t,"mousemove"),this._mouseup$=i.fromEvent(t,"mouseup"),this._touchstart$=i.fromEvent(t,"touchstart"),this._touchmove$=i.fromEvent(t,"touchmove"),this._touchend$=i.fromEvent(t,"touchend")},n.prototype._enableListeners=function(){this._enabledListener||(this._enableMouseListeners(),this._isTouchDevice()&&this._enableTouchListeners(),this._enabledListener=!0)},n.prototype._disableListeners=function(){this._subscriptions.forEach(function(t){return t.unsubscribe()}),this._enabledListener=!1},n.prototype._isTouchDevice=function(){return"ontouchstart"in window||0<navigator.maxTouchPoints},n.prototype._enableTouchListeners=function(){var i=this,t=this._touchstart$.subscribe(function(t){return i.mouseDownEventHandler(t)}),e=this._touchmove$.subscribe(function(t){return i.mouseMoveEventHandler(t)}),s=this._touchend$.subscribe(function(t){return i.mouseUpEventHandler(t)});this._subscriptions.push(t,e,s)},n.prototype._enableMouseListeners=function(){var i=this,t=this._documentMousemove$.subscribe(function(t){return i.mouseMoveEventHandler(t)}),e=this._documentMouseup$.subscribe(function(t){return i.mouseUpEventHandler(t)}),s=this._mousedown$.subscribe(function(t){return i.mouseDownEventHandler(t)}),n=this._mousemove$.subscribe(function(t){return i.mouseMoveEventHandler(t)}),o=this._mouseup$.subscribe(function(t){return i.mouseUpEventHandler(t)});this._subscriptions.push(t,e,s,n,o)},n.CONST_DEFAULT_CONFIG={margins:[10],draggable:!0,resizable:!0,max_cols:0,max_rows:0,visible_cols:0,visible_rows:0,col_width:250,row_height:250,cascade:"up",min_width:100,min_height:100,fix_to_grid:!1,auto_style:!0,auto_resize:!1,maintain_ratio:!1,prefer_new:!1,zoom_on_drag:!1,limit_to_screen:!1,center_to_screen:!1,resize_directions:n.CONST_DEFAULT_RESIZE_DIRECTIONS=["bottomright","bottomleft","topright","topleft","right","left","bottom","top"],element_based_row_height:!1,fix_item_position_direction:"cascade",fix_collision_position_direction:"cascade",allow_overlap:!1},n.decorators=[{type:r.Directive,args:[{selector:"[ngGrid]",inputs:["config: ngGrid"],host:{"(window:resize)":"resizeEventHandler($event)"}}]}],n.ctorParameters=function(){return[{type:r.KeyValueDiffers},{type:r.ElementRef},{type:r.Renderer},{type:r.ComponentFactoryResolver}]},n.propDecorators={onDragStart:[{type:r.Output}],onDrag:[{type:r.Output}],onDragStop:[{type:r.Output}],onResizeStart:[{type:r.Output}],onResize:[{type:r.Output}],onResizeStop:[{type:r.Output}],onItemChange:[{type:r.Output}]},n}(),s=function(){function o(t,i,e,s,n){this._differs=t,this._ngEl=i,this._renderer=e,this._ngGrid=s,this.containerRef=n,this.onItemChange=new r.EventEmitter(!1),this.onDragStart=new r.EventEmitter,this.onDrag=new r.EventEmitter,this.onDragStop=new r.EventEmitter,this.onDragAny=new r.EventEmitter,this.onResizeStart=new r.EventEmitter,this.onResize=new r.EventEmitter,this.onResizeStop=new r.EventEmitter,this.onResizeAny=new r.EventEmitter,this.onChangeStart=new r.EventEmitter,this.onChange=new r.EventEmitter,this.onChangeStop=new r.EventEmitter,this.onChangeAny=new r.EventEmitter,this.ngGridItemChange=new r.EventEmitter,this.isFixed=!1,this.isDraggable=!0,this.isResizable=!0,this.minWidth=0,this.minHeight=0,this.uid=null,this._currentPosition={col:1,row:1},this._size={x:1,y:1},this._config=o.CONST_DEFAULT_CONFIG,this._userConfig=null,this._added=!1,this._maxCols=0,this._minCols=0,this._maxRows=0,this._minRows=0,this._resizeDirections=[],this._zIndex=0}return Object.defineProperty(o.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._renderer.setStyle(this._ngEl.nativeElement,"z-index",t.toString()),this._zIndex=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"config",{set:function(t){this._userConfig=t;var i=Object.assign({},o.CONST_DEFAULT_CONFIG,t);for(var e in o.CONST_DEFAULT_CONFIG)null==i[e]&&(i[e]=o.CONST_DEFAULT_CONFIG[e]);this.setConfig(i),null!=this._userConfig&&(null==this._differ&&(this._differ=this._differs.find(this._userConfig).create()),this._differ.diff(this._userConfig)),this._added||(this._added=!0,this._ngGrid.addItem(this)),this._recalculateDimensions(),this._recalculatePosition()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"sizex",{get:function(){return this._size.x},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"sizey",{get:function(){return this._size.y},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"col",{get:function(){return this._currentPosition.col},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"row",{get:function(){return this._currentPosition.row},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"currentCol",{get:function(){return this._currentPosition.col},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"currentRow",{get:function(){return this._currentPosition.row},enumerable:!0,configurable:!0}),o.prototype.onResizeStartEvent=function(){var t=this.getEventOutput();this.onResizeStart.emit(t),this.onResizeAny.emit(t),this.onChangeStart.emit(t),this.onChangeAny.emit(t)},o.prototype.onResizeEvent=function(){var t=this.getEventOutput();this.onResize.emit(t),this.onResizeAny.emit(t),this.onChange.emit(t),this.onChangeAny.emit(t)},o.prototype.onResizeStopEvent=function(){var t=this.getEventOutput();this.onResizeStop.emit(t),this.onResizeAny.emit(t),this.onChangeStop.emit(t),this.onChangeAny.emit(t),this.onConfigChangeEvent()},o.prototype.onDragStartEvent=function(){var t=this.getEventOutput();this.onDragStart.emit(t),this.onDragAny.emit(t),this.onChangeStart.emit(t),this.onChangeAny.emit(t)},o.prototype.onDragEvent=function(){var t=this.getEventOutput();this.onDrag.emit(t),this.onDragAny.emit(t),this.onChange.emit(t),this.onChangeAny.emit(t)},o.prototype.onDragStopEvent=function(){var t=this.getEventOutput();this.onDragStop.emit(t),this.onDragAny.emit(t),this.onChangeStop.emit(t),this.onChangeAny.emit(t),this.onConfigChangeEvent()},o.prototype.onCascadeEvent=function(){this.onConfigChangeEvent()},o.prototype.ngOnInit=function(){this._renderer.addClass(this._ngEl.nativeElement,"grid-item"),this._ngGrid.autoStyle&&this._renderer.setStyle(this._ngEl.nativeElement,"position","absolute"),this._recalculateDimensions(),this._recalculatePosition(),this.config=this._userConfig},o.prototype.canDrag=function(t){return!!this.isDraggable&&(!this._dragHandle||this.findHandle(this._dragHandle,t.target))},o.prototype.findHandle=function(t,i){try{for(var e=i;e&&e!=this._ngEl.nativeElement;){if(this.elementMatches(e,t))return!0;e=e.parentElement}}catch(s){}return!1},o.prototype.canResize=function(t){if(!this.isResizable)return null;if(this._resizeHandle){if("string"==typeof this._resizeHandle)return this.findHandle(this._resizeHandle,t.target)?"bottomright":null;if("object"!=typeof this._resizeHandle)return null;try{for(var i=I(["bottomright","bottomleft","topright","topleft","right","left","bottom","top"]),e=i.next();!e.done;e=i.next()){if((_=e.value)in this._resizeHandle&&this.findHandle(this._resizeHandle[_],t.target))return _}}catch(c){s={error:c}}finally{try{e&&!e.done&&(n=i["return"])&&n.call(i)}finally{if(s)throw s.error}}return null}if(this._borderSize<=0)return null;var s,n,o,r,h=this._getMousePosition(t);try{for(var a=I(this._resizeDirections),l=a.next();!l.done;l=a.next()){var _=l.value;if(this.canResizeInDirection(_,h))return _}}catch(g){o={error:g}}finally{try{l&&!l.done&&(r=a["return"])&&r.call(a)}finally{if(o)throw o.error}}return null},o.prototype.onMouseMove=function(t){if(this._ngGrid.autoStyle)if(this._ngGrid.resizeEnable){var i="default";switch(this.canResize(t)){case"bottomright":case"topleft":i="nwse-resize";break;case"topright":case"bottomleft":i="nesw-resize";break;case"top":case"bottom":i="ns-resize";break;case"left":case"right":i="ew-resize";break;default:this._ngGrid.dragEnable&&this.canDrag(t)&&(i="move")}this._renderer.setStyle(this._ngEl.nativeElement,"cursor",i)}else this._ngGrid.dragEnable&&this.canDrag(t)?this._renderer.setStyle(this._ngEl.nativeElement,"cursor","move"):this._renderer.setStyle(this._ngEl.nativeElement,"cursor","default")},o.prototype.ngOnDestroy=function(){this._added&&this._ngGrid.removeItem(this)},o.prototype.getElement=function(){return this._ngEl},o.prototype.getDragHandle=function(){return this._dragHandle},o.prototype.getResizeHandle=function(){return this._resizeHandle},o.prototype.getDimensions=function(){return{width:this._elemWidth,height:this._elemHeight}},o.prototype.getSize=function(){return this._size},o.prototype.getPosition=function(){return{left:this._elemLeft,top:this._elemTop}},o.prototype.getGridPosition=function(){return this._currentPosition},o.prototype.setConfig=function(t){this._config=t,this._payload=t.payload,this._currentPosition.col=t.col?t.col:o.CONST_DEFAULT_CONFIG.col,this._currentPosition.row=t.row?t.row:o.CONST_DEFAULT_CONFIG.row,this._size.x=t.sizex?t.sizex:o.CONST_DEFAULT_CONFIG.sizex,this._size.y=t.sizey?t.sizey:o.CONST_DEFAULT_CONFIG.sizey,this._dragHandle=t.dragHandle,this._resizeHandle=t.resizeHandle,this._borderSize=t.borderSize,this.isDraggable=!!t.draggable,this.isResizable=!!t.resizable,this.isFixed=!!t.fixed,this._resizeDirections=t.resizeDirections||this._ngGrid.resizeDirections,this._maxCols=!isNaN(t.maxCols)&&isFinite(t.maxCols)?t.maxCols:0,this._minCols=!isNaN(t.minCols)&&isFinite(t.minCols)?t.minCols:0,this._maxRows=!isNaN(t.maxRows)&&isFinite(t.maxRows)?t.maxRows:0,this._minRows=!isNaN(t.minRows)&&isFinite(t.minRows)?t.minRows:0,this.minWidth=!isNaN(t.minWidth)&&isFinite(t.minWidth)?t.minWidth:0,this.minHeight=!isNaN(t.minHeight)&&isFinite(t.minHeight)?t.minHeight:0,0<this._minCols&&0<this._maxCols&&this._minCols>this._maxCols&&(this._minCols=0),0<this._minRows&&0<this._maxRows&&this._minRows>this._maxRows&&(this._minRows=0),this._added&&this._ngGrid.updateItem(this),this._size=this.fixResize(this._size),this._recalculatePosition(),this._recalculateDimensions()},o.prototype.ngDoCheck=function(){if(null!=this._differ){var t=this._differ.diff(this._userConfig);if(null!=t)return this._applyChanges(t)}return!1},o.prototype.setSize=function(t,i){void 0===i&&(i=!0),t=this.fixResize(t),this._size=t,i&&this._recalculateDimensions(),this.onItemChange.emit(this.getEventOutput())},o.prototype.setGridPosition=function(t,i){void 0===i&&(i=!0),this._currentPosition=t,i&&this._recalculatePosition(),this.onItemChange.emit(this.getEventOutput())},o.prototype.getEventOutput=function(){return{uid:this.uid,payload:this._payload,col:this._currentPosition.col,row:this._currentPosition.row,sizex:this._size.x,sizey:this._size.y,width:this._elemWidth,height:this._elemHeight,left:this._elemLeft,top:this._elemTop}},o.prototype.setPosition=function(t,i){switch(this._cascadeMode){case"up":case"left":default:this._renderer.setStyle(this._ngEl.nativeElement,"left",t+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"top",i+"px");break;case"right":this._renderer.setStyle(this._ngEl.nativeElement,"right",t+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"top",i+"px");break;case"down":this._renderer.setStyle(this._ngEl.nativeElement,"left",t+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"bottom",i+"px")}this._elemLeft=t,this._elemTop=i},o.prototype.setCascadeMode=function(t){switch(this._cascadeMode=t){case"up":case"left":default:this._renderer.setStyle(this._ngEl.nativeElement,"left",this._elemLeft+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"top",this._elemTop+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"right",null),this._renderer.setStyle(this._ngEl.nativeElement,"bottom",null);break;case"right":this._renderer.setStyle(this._ngEl.nativeElement,"right",this._elemLeft+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"top",this._elemTop+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"left",null),this._renderer.setStyle(this._ngEl.nativeElement,"bottom",null);break;case"down":this._renderer.setStyle(this._ngEl.nativeElement,"left",this._elemLeft+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"bottom",this._elemTop+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"right",null),this._renderer.setStyle(this._ngEl.nativeElement,"top",null)}},o.prototype.setDimensions=function(t,i){t<this.minWidth&&(t=this.minWidth),i<this.minHeight&&(i=this.minHeight),this._renderer.setStyle(this._ngEl.nativeElement,"width",t+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"height",i+"px"),this._elemWidth=t,this._elemHeight=i},o.prototype.startMoving=function(){this._renderer.addClass(this._ngEl.nativeElement,"moving");var t=window.getComputedStyle(this._ngEl.nativeElement);this._ngGrid.autoStyle&&this._renderer.setStyle(this._ngEl.nativeElement,"z-index",(parseInt(t.getPropertyValue("z-index"))+1).toString())},o.prototype.stopMoving=function(){this._renderer.removeClass(this._ngEl.nativeElement,"moving");var t=window.getComputedStyle(this._ngEl.nativeElement);this._ngGrid.autoStyle&&this._renderer.setStyle(this._ngEl.nativeElement,"z-index",(parseInt(t.getPropertyValue("z-index"))-1).toString())},o.prototype.recalculateSelf=function(){this._recalculatePosition(),this._recalculateDimensions()},o.prototype.fixResize=function(t){return 0<this._maxCols&&t.x>this._maxCols&&(t.x=this._maxCols),0<this._maxRows&&t.y>this._maxRows&&(t.y=this._maxRows),0<this._minCols&&t.x<this._minCols&&(t.x=this._minCols),0<this._minRows&&t.y<this._minRows&&(t.y=this._minRows),t.x*this._ngGrid.colWidth+(this._ngGrid.marginLeft+this._ngGrid.marginRight)*(t.x-1)<this.minWidth&&(t.x=Math.ceil((this.minWidth+this._ngGrid.marginRight+this._ngGrid.marginLeft)/(this._ngGrid.colWidth+this._ngGrid.marginRight+this._ngGrid.marginLeft))),t.y*this._ngGrid.rowHeight+(this._ngGrid.marginTop+this._ngGrid.marginBottom)*(t.y-1)<this.minHeight&&(t.y=Math.ceil((this.minHeight+this._ngGrid.marginBottom+this._ngGrid.marginTop)/(this._ngGrid.rowHeight+this._ngGrid.marginBottom+this._ngGrid.marginTop))),t},o.prototype.elementMatches=function(t,i){if(!t)return!1;if(t.matches)return t.matches(i);if(t.oMatchesSelector)return t.oMatchesSelector(i);if(t.msMatchesSelector)return t.msMatchesSelector(i);if(t.mozMatchesSelector)return t.mozMatchesSelector(i);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(i);if(!t.document||!t.ownerDocument)return!1;for(var e=(t.document||t.ownerDocument).querySelectorAll(i),s=e.length;0<=--s&&e.item(s)!==t;);return-1<s},o.prototype._recalculatePosition=function(){var t=(this._ngGrid.colWidth+this._ngGrid.marginLeft+this._ngGrid.marginRight)*(this._currentPosition.col-1)+this._ngGrid.marginLeft+this._ngGrid.screenMargin,i=(this._ngGrid.rowHeight+this._ngGrid.marginTop+this._ngGrid.marginBottom)*(this._currentPosition.row-1)+this._ngGrid.marginTop;this.setPosition(t,i)},o.prototype._recalculateDimensions=function(){this._size.x<this._ngGrid.minCols&&(this._size.x=this._ngGrid.minCols),this._size.y<this._ngGrid.minRows&&(this._size.y=this._ngGrid.minRows);var t=this._ngGrid.colWidth*this._size.x+(this._ngGrid.marginLeft+this._ngGrid.marginRight)*(this._size.x-1),i=this._ngGrid.rowHeight*this._size.y+(this._ngGrid.marginTop+this._ngGrid.marginBottom)*(this._size.y-1),e=Math.max(this.minWidth,this._ngGrid.minWidth,t),s=Math.max(this.minHeight,this._ngGrid.minHeight,i);this.setDimensions(e,s)},o.prototype._getMousePosition=function(t){if(t.originalEvent&&t.originalEvent.touches){var i=t.originalEvent;t=i.touches.length?i.touches[0]:i.changedTouches.length?i.changedTouches[0]:t}else t.touches&&(t=t.touches.length?t.touches[0]:t.changedTouches.length?t.changedTouches[0]:t);var e=this._ngEl.nativeElement.getBoundingClientRect();return{left:t.clientX-e.left,top:t.clientY-e.top}},o.prototype._applyChanges=function(t){var i=this,e=!1,s=function(t){i._config[t.key]!==t.currentValue&&(i._config[t.key]=t.currentValue,e=!0)};return t.forEachAddedItem(s),t.forEachChangedItem(s),t.forEachRemovedItem(function(t){e=!0,delete i._config[t.key]}),e&&this.setConfig(this._config),e},o.prototype.onConfigChangeEvent=function(){null!==this._userConfig&&(this._config.sizex=this._userConfig.sizex=this._size.x,this._config.sizey=this._userConfig.sizey=this._size.y,this._config.col=this._userConfig.col=this._currentPosition.col,this._config.row=this._userConfig.row=this._currentPosition.row,this.ngGridItemChange.emit(this._userConfig))},o.prototype.canResizeInDirection=function(t,i){switch(t){case"bottomright":return i.left<this._elemWidth&&i.left>this._elemWidth-this._borderSize&&i.top<this._elemHeight&&i.top>this._elemHeight-this._borderSize;case"bottomleft":return i.left<this._borderSize&&i.top<this._elemHeight&&i.top>this._elemHeight-this._borderSize;case"topright":return i.left<this._elemWidth&&i.left>this._elemWidth-this._borderSize&&i.top<this._borderSize;case"topleft":return i.left<this._borderSize&&i.top<this._borderSize;case"right":return i.left<this._elemWidth&&i.left>this._elemWidth-this._borderSize;case"left":return i.left<this._borderSize;case"bottom":return i.top<this._elemHeight&&i.top>this._elemHeight-this._borderSize;case"top":return i.top<this._borderSize;default:return!1}},o.CONST_DEFAULT_CONFIG={uid:null,col:1,row:1,sizex:1,sizey:1,dragHandle:null,resizeHandle:null,fixed:!1,draggable:!0,resizable:!0,borderSize:25,resizeDirections:null},o.decorators=[{type:r.Directive,args:[{selector:"[ngGridItem]",inputs:["config: ngGridItem"]}]}],o.ctorParameters=function(){return[{type:r.KeyValueDiffers},{type:r.ElementRef},{type:r.Renderer2},{type:e},{type:r.ViewContainerRef}]},o.propDecorators={onItemChange:[{type:r.Output}],onDragStart:[{type:r.Output}],onDrag:[{type:r.Output}],onDragStop:[{type:r.Output}],onDragAny:[{type:r.Output}],onResizeStart:[{type:r.Output}],onResize:[{type:r.Output}],onResizeStop:[{type:r.Output}],onResizeAny:[{type:r.Output}],onChangeStart:[{type:r.Output}],onChange:[{type:r.Output}],onChangeStop:[{type:r.Output}],onChangeAny:[{type:r.Output}],ngGridItemChange:[{type:r.Output}]},o}(),n=function(){function t(){}return t.decorators=[{type:r.NgModule,args:[{declarations:[e,s,h],entryComponents:[h],exports:[e,s]}]}],t}();t.NgGrid=e,t.NgGridItem=s,t.NgGridPlaceholder=h,t.NgGridModule=n,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=angular2-grid.umd.min.js.map